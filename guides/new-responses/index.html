<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Responses Guide | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/prism.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><style data-emotion-css="1vor854">body{font-family:"Zilla Slab",serif;font-weight:300;font-size:24px;line-height:36px;margin:0;box-sizing:border-box;}@media only screen and (min-width:751px){body{font-size:20px;}}@media only screen and (min-width:){body{font-size:20px;}}*,*:before,*:after{box-sizing:inherit;}h1,h2,h3,h4,h5,h6{font-weight:normal;margin:5px 0;overflow:hidden;text-overflow:ellipsis;}p{margin:5px 0;word-break:break-word;}h1{font-size:1.75em;line-height:1.5em;}h2{font-size:1.5em;line-height:1.2em;}h3{font-size:1.25em;line-height:1.1em;}h4{font-size:1.2em;line-height:1.1em;}h5{font-size:1.1em;line-height:1.1em;}h6{font-size:1em;line-height:1.1em;}table,th,td{border:1px solid #c7c7c7;border-collapse:collapse;}table{margin-bottom:10px;}th{text-align:left;}th,td{padding:10px;}pre[class*="language-"]{margin:0;background:#222233;}:not(pre) > code[class*="language-"]{white-space:nowrap;}</style><style data-emotion-css="137i3vd">.css-137i3vd{display:none;}@media only screen and (min-width:751px){.css-137i3vd{display:block;width:100vw;max-width:100%;background:#222233;padding:0;position:fixed;z-index:1;}.css-137i3vd #home-link{font-size:1.5em;color:#ff9800;}}</style><header class="css-137i3vd e132noc00"><style data-emotion-css="1j4n5ho">.css-1j4n5ho{color:#efefef;}.css-1j4n5ho li{margin-right:20px;padding:0;}.css-1j4n5ho li.base > a{color:#efefef;font-size:1.1em;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;height:50px;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-bottom:3px solid #222233;padding:0 5px;}.css-1j4n5ho li.base > a:hover{color:#ff9800;}.css-1j4n5ho li.base > a.active{color:#ff9800;border-bottom-color:#ff9800;}.css-1j4n5ho li.base > a.activated{color:#2196f3;border-bottom-color:#2196f3;}.css-1j4n5ho a{-webkit-text-decoration:none;text-decoration:none;}</style><nav class="css-1j4n5ho e132noc02"><style data-emotion-css="192aemx">.css-192aemx{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row wrap;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-align-items:flex-end;-webkit-box-align:flex-end;-ms-flex-align:flex-end;align-items:flex-end;list-style:none;padding:0;margin:0;max-width:100%;}</style><ul class="css-192aemx e132noc01"><li class="base"><a href="/" id="home-link" class=" ">Curi</a></li><li class="base"><a href="/packages/" data-hide="false" class="group ">API</a></li><li class="base"><a href="/guides/" data-hide="false" class="group active">Guides</a></li><li class="base"><a href="/tutorial/" data-hide="false" class="group ">Tutorials</a></li><li class="base"><a href="/examples/" data-hide="false" class="group ">Examples</a></li><li class="base"><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><style data-emotion-css="bupcgl">.css-bupcgl{position:fixed;right:15px;bottom:15px;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:column-reverse;-ms-flex-flow:column-reverse;flex-flow:column-reverse;z-index:9999;}</style><div class="css-bupcgl e18ecyrg1"><style data-emotion-css="8wphu1">.css-8wphu1{width:75px;height:75px;border-radius:40px;border:0;margin-top:10px;font-size:1em;font-family:"Zilla Slab",serif;background:#2196f3;}@media only screen and (min-width:751px){.css-8wphu1{display:none;}}</style><button type="button" class="toggler css-8wphu1 e1105ass0">Menu</button><style data-emotion-css="4pglcz">.css-4pglcz{width:75px;height:75px;border-radius:40px;border:0;margin-top:10px;font-size:1em;font-family:"Zilla Slab",serif;background:#c7c7c7;}@media only screen and (min-width:751px){.css-4pglcz{display:none;}}.css-4pglcz.active{background:#81c784;}</style><button hidden="" class="false active main css-4pglcz e1105ass1">Main</button><button hidden="" class="false false page css-4pglcz e1105ass1">Page</button></div><style data-emotion-css="b9kg8f">.css-b9kg8f{display:none;position:fixed;overflow-y:scroll;width:100vw;height:100vh;background:#efefef;z-index:999;padding:15px;}.css-b9kg8f.visible{display:block;}.css-b9kg8f ul{margin:3px 0;padding-left:0px;list-style:none;}.css-b9kg8f li{margin:3px 0;}.css-b9kg8f a{-webkit-text-decoration:none;text-decoration:none;display:inline-block;color:#222233;}.css-b9kg8f h3{border-bottom:1px solid #333;}.css-b9kg8f .active{font-weight:bold;}.css-b9kg8f .children{display:none;background:#efefef;padding:10px;}.css-b9kg8f .children.visible{display:block;position:fixed;top:0;bottom:0;left:0;right:0;overflow-y:scroll;}@media only screen and (min-width:751px){.css-b9kg8f{display:none;}.css-b9kg8f.visible{display:none;}}</style><div hidden="" class=" css-b9kg8f e18ecyrg0"><nav></nav></div><style data-emotion-css="89bx5e">.css-89bx5e{width:100vw;max-width:100%;padding:10px 10px 0;margin-bottom:20px;}.css-89bx5e a{color:#222233;}@media only screen and (min-width:751px){.css-89bx5e{padding:50px 0 0;margin-bottom:0;}}</style><main tabindex="-1" style="outline:none" class="css-89bx5e e1fl12nk0"><style data-emotion-css="csv88t">.css-csv88t{position:relative;}@media only screen and (min-width:751px){.css-csv88t{display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-flex-flow:row nowrap;-ms-flex-flow:row nowrap;flex-flow:row nowrap;}}@media only screen and (min-width:751px){.css-csv88t{max-width:100vw;}}</style><div class="css-csv88t e1hcridg0"><style data-emotion-css="q1fc1d">@media only screen and (min-width:751px){.css-q1fc1d{margin-left:275px;}}</style><div class="css-q1fc1d e1hcridg1"><style data-emotion-css="1l1nc79">.css-1l1nc79{margin-top:15px;}.css-1l1nc79 p{margin:0 0 25px;font-size:0.8em;}.css-1l1nc79 .aside{padding:5px 10px;border-left:2px solid $border-green;background:#e8f5e9;margin-top:15px;}.css-1l1nc79 .aside .inline-code{background:#81c784 !important;}@media only screen and (min-width:751px){.css-1l1nc79{max-width:751px;}.css-1l1nc79 p{font-size:1em;}.css-1l1nc79.centered{margin:0 auto;}}</style><div class="section css-1l1nc79"><h1>New Responses</h1><p>Curi uses an observer pattern to call registered functions (called response handlers) when there is a new response. The primary use care for this is to re-render the application whenever there is a new response, but other functionalities (like logging) can also be performed.</p></div><style data-emotion-css="1kr8jn0">.css-1kr8jn0{margin-top:15px;}.css-1kr8jn0 p{margin:0 0 25px;font-size:0.8em;}.css-1kr8jn0 .aside{padding:5px 10px;border-left:2px solid $border-green;background:#e8f5e9;margin-top:15px;}.css-1kr8jn0 .aside .inline-code{background:#81c784 !important;}@media only screen and (min-width:751px){.css-1kr8jn0{max-width:751px;}.css-1kr8jn0 p{font-size:1em;}.css-1kr8jn0.centered{margin:0 auto;}}.css-1kr8jn0 .header-link{-webkit-text-decoration:none;text-decoration:none;}.css-1kr8jn0 .header-link::after{content:"#";color:#333;margin-left:5px;}@media only screen and (min-width:751px){.css-1kr8jn0:before{content:"";display:block;margin-top:-50px;height:50px;visibility:hidden;}.css-1kr8jn0 p{font-size:1em;}.css-1kr8jn0 .header-link::after{display:none;}.css-1kr8jn0 .header-link:hover::after{display:inline-block;}}</style><div class="section css-1kr8jn0" id="response-handlers"><h3><a href="#response-handlers" class="header-link">Response Handlers</a></h3><p>When response handlers are called, they are passed an object with three properties:<!-- --> <a href="/packages/@curi/router/v1/#properties"><style data-emotion-css="jo5c25">.css-jo5c25{padding:0.1em;border-radius:0.3em;white-space:normal;background:#fff;color:#222233;text-shadow:none;white-space:wrap;}.css-jo5c25 .token{color:#222233;}</style><code class="inline-code css-jo5c25 eutm4hs0">router</code></a>,<!-- --> <a href="/guides/responses/"><code class="inline-code css-jo5c25 eutm4hs0">response</code></a>, and<!-- --> <a href="/guides/navigation-objects/"><code class="inline-code css-jo5c25 eutm4hs0">navigation</code></a>. Which objects/properties you use depends on what the response handler is doing.</p><style data-emotion-css="xg7t84">.css-xg7t84{width:100%;margin:0 0 25px;font-size:0.8em;}.css-xg7t84 pre{white-space:pre-wrap;height:100%;vertical-align:top;}@media only screen and (min-width:751px){.css-xg7t84{font-size:1em;}.css-xg7t84 code{min-width:200px;white-space:pre-wrap;}}</style><div class="css-xg7t84 e12etsbl0"><pre><code class="language-javascript">function responseHandler({
  router,
  response,
  navigation
}) {
  // ...
}</code></pre></div></div><div class="section css-1kr8jn0" id="registering"><h3><a href="#registering" class="header-link">Registering Response Handlers</a></h3><p>There are three ways to attach response handlers to the router:<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">router.once()</code> and <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code> or as a side effect.</p><p>Response handlers registered with <code class="inline-code css-jo5c25 eutm4hs0">router.once()</code> will only be called one time, while those registered with<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code> and side effects will be called for every new response.</p><p>When you register a response handler using <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code>, it will return a function that you can use to stop calling the response handler for new responses. You should rarely need to do this, but it can be useful for memory management if you are adding and removing lots of observers.</p><div class="css-xg7t84 e12etsbl0"><pre><code class="language-javascript">// fn will only be called one time
router.once(fn);

// obs will be called for every new response
const stop = router.observe(fn);</code></pre></div></div><div class="section css-1kr8jn0" id="use-cases"><h3><a href="#use-cases" class="header-link">Use Cases</a></h3><p>What should you use response handlers for?</p><div class="section css-1kr8jn0" id="setup"><h4><a href="#setup" class="header-link">Setup</a></h4><p>If any of the routes in an application have <code class="inline-code css-jo5c25 eutm4hs0">resolve</code> <!-- -->functions, when they match their responses are created asynchronously. When the application first renders, if the router matches an async route, the response isn&#x27;t immediately ready to use. To deal with this, you can use an observer to render once the initial response is ready.</p><p>A setup function only needs to be called one time, so you can register it with <code class="inline-code css-jo5c25 eutm4hs0">router.once()</code>.</p><style data-emotion-css="o0tph9">.css-o0tph9{padding:10px 5px;margin:5px 0;border:1px solid #c7c7c7;background:#eeeeee;}.css-o0tph9 p:last-child{margin-bottom:0;}.aside .css-o0tph9{background:#fff;}.css-o0tph9 .inline-code{background:#fff !important;}</style><div class="css-o0tph9 e1bjkffy0"><strong>Note:</strong> <p>In most applications, waiting for the initial response is the only time you may need to write response handlers yourself.</p></div><div class="css-xg7t84 e12etsbl0"><pre><code class="language-jsx">const Router = create_router_component(router);
              
function setup() {
  ReactDOM.render((
    &lt;Router&gt;
      &lt;App /&gt;
    &lt;/Router&gt;
  ), document.getElementById(&#x27;root&#x27;));
}

router.once(setup);</code></pre></div></div><div class="section css-1kr8jn0" id="rendering"><h4><a href="#rendering" class="header-link">Rendering</a></h4><p>Rendering libraries need to know when there is a new response so that they can re-render the application.</p><p>The Curi rendering packages (<a href="/packages/@curi/react-dom/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/react-dom</code></a>,<!-- --> <a href="/packages/@curi/react-native/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/react-native</code></a>,<!-- --> <a href="/packages/@curi/vue/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/vue</code></a>, and<!-- --> <a href="/packages/@curi/svelte/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/svelte</code></a>) setup an observer internally so that they can automatically re-render.</p><p>If you are using vanilla JavaScript to render your application or you are writing your own framework implementation, you would use<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code> to re-render new responses.</p><div class="css-xg7t84 e12etsbl0"><pre><code class="language-javascript">function observer({ response }) {
  // let the app know there is a new response
}

router.observe(observer);</code></pre></div></div><div class="section css-1kr8jn0" id="side-effects"><h4><a href="#side-effects" class="header-link">Side Effects</a></h4><p>Side effects are observers that are provided to the router at creation instead of by calling <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code>. These can be useful for tasks that are not rendering related as well as for tasks that need to be performed after a render has completed.</p><p>The<!-- --> <a href="/packages/@curi/side-effect-title/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/side-effect-title</code></a> <!-- -->package provides a side effect that will use<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">response.title</code> to set the page&#x27;s<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">document.title</code>.</p><p>With single-page applications, clicking on links wish hashes won&#x27;t always scroll to the matching element in the page. The<!-- --> <a href="/packages/@curi/side-effect-scroll/v1/"><code class="inline-code css-jo5c25 eutm4hs0">@curi/side-effect-scroll</code></a> <!-- -->package adds this behavior by scrolling the page to the element that matches the new response&#x27;s hash (<code class="inline-code css-jo5c25 eutm4hs0">response.location.hash</code>) after the new response has rendered.</p><p>If you need to add logging to your application, you could write your own observer to do this. Your observer can either be added as a side effect when the router is constructed or later using<!-- --> <code class="inline-code css-jo5c25 eutm4hs0">router.observe()</code>.</p><div class="css-xg7t84 e12etsbl0"><pre><code class="language-javascript">function logger({ response }) {
  loggingAPI.add(response.location);
}

// as a side-effect
const router = create_router(browser, routes, {
  side_effects: [{ fn: logger }]
});

// as an observer
router.observe(logger);</code></pre></div></div></div></div><style data-emotion-css="64fwtw">.css-64fwtw{display:none;}@media only screen and (min-width:751px){.css-64fwtw{background:#efefef;display:block;position:fixed;top:50px;bottom:0px;overflow:auto;-webkit-flex:0 0;-ms-flex:0 0;flex:0 0;-webkit-order:-1;-ms-flex-order:-1;order:-1;padding:25px;margin-right:25px;}}</style><div class="css-64fwtw e1hcridg2"><style data-emotion-css="1eimyfs">.css-1eimyfs{width:200px;}.css-1eimyfs p{margin:0;}.css-1eimyfs a{-webkit-text-decoration:none;text-decoration:none;display:block;}.css-1eimyfs ol{padding-left:0;margin-top:0;list-style-type:none;}.css-1eimyfs ol ol{padding-left:15px;font-size:0.9em;}</style><div class="css-1eimyfs e1evhjzy0"><ol><li><a href="#response-handlers">Response Handlers</a></li><li><a href="#registering">Registering Response Handlers</a></li><li><a href="#use-cases">Use Cases</a><ol><li><a href="#setup">Setup</a></li><li><a href="#rendering">Rendering</a></li><li><a href="#side-effects">Side Effects</a></li></ol></li></ol></div></div></div></main></div>
    <script src="https://cdn.polyfill.io/v2/polyfill.js?features=Object.assign"></script>
    <script src="https://unpkg.com/react@16.8.6/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.8.6/umd/react-dom.production.min.js"></script>
    <script src="/static/js/prism.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
