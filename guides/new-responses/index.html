<!doctype html>
<html lang="en" class="font-serif text-small-screen md:text-regular-screen font-light m-0 box-border">
  <head>
    <meta charset="utf-8">
    <meta name="description" content="Learn how to use Curi router observers to react to new responses">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>New Responses Guide | Curi Documentation</title>
    <link href="https://fonts.googleapis.com/css?family=Zilla+Slab:300,400" rel="stylesheet">
    <link href="/static/css/prism.css" rel="stylesheet">
    <link href="/static/index.css" rel="stylesheet">
  </head>
  <body>
    <div id="root"><header class="hidden md:block w-screen max-w-full bg-purple p-0 fixed z-10"><nav class="text-gray-100"><ul role="menubar" class="flex flex-row flex-wrap items-end p-0 m-0 max-w-full"><li class="p-0 pr-2 pl-0"><a class=" text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange md:text-2xl md:text-bright-orange" href="/">Curi</a></li><li class="p-0 pr-2 pl-0" aria-haspopup="true"><a class=" text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange " href="/v2/">API</a><div class="hidden absolute w-screen left-0 text-purple border-0 border-b-2 border-purple"><ul class="flex flex-row flex-no-wrap justify-start bg-light-blue list-none m-0 p-0"><li><menu class="my-0 mx-5"><h3>router</h3><ul><li><a class=" " href="/v2/@curi/router/">router</a></li><li><a class=" " href="/v2/@curi/interactions/">interactions</a></li></ul></menu></li><li><menu class="my-0 mx-5"><h3>render</h3><ul><li><a class=" " href="/v2/@curi/react-dom/">react-dom</a></li><li><a class=" " href="/v2/@curi/react-native/">react-native</a></li><li><a class=" " href="/v2/@curi/svelte/">svelte</a></li><li><a class=" " href="/v2/@curi/vue/">vue</a></li></ul></menu></li><li><menu class="my-0 mx-5"><h3>other</h3><ul><li><a class=" " href="/v2/@curi/static/">static</a></li><li><a class=" " href="/v2/@curi/helpers/">helpers</a></li><li><a class=" " href="/v2/@curi/types/">types</a></li></ul></menu></li></ul></div></li><li class="p-0 pr-2 pl-0" aria-haspopup="true"><a class="text-bright-orange border-bright-orange text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange " href="/guides/">Guides</a><div class="hidden absolute w-screen left-0 text-purple border-0 border-b-2 border-purple"><ul class="flex flex-row flex-no-wrap justify-start bg-light-blue list-none m-0 p-0"><menu class="my-0 mx-5"><h3>basic</h3><ul><li><a class=" " href="/guides/installation/">Installation</a></li><li><a class=" " href="/guides/getting-started/">Getting Started</a></li><li><a class=" " href="/guides/history/">History</a></li><li><a class=" " href="/guides/routes/">Routes</a></li><li><a class=" " href="/guides/responses/">Responses</a></li><li><a class=" " href="/guides/navigation-objects/">Navigation Objects</a></li><li><a class=" " href="/guides/sync-or-async/">Sync or Async</a></li><li><a class="font-bold " href="/guides/new-responses/">New Responses</a></li><li><a class=" " href="/guides/accessibility/">Accessibility</a></li></ul></menu><menu class="my-0 mx-5"><h3>rendering</h3><ul><li><a class=" " href="/guides/react-dom/">React DOM</a></li><li><a class=" " href="/guides/react-native/">React Native</a></li><li><a class=" " href="/guides/svelte/">Svelte</a></li><li><a class=" " href="/guides/vue/">Vue</a></li></ul></menu><menu class="my-0 mx-5"><h3>advanced</h3><ul><li><a class=" " href="/guides/route-interactions/">Route Interactions</a></li><li><a class=" " href="/guides/side-effects/">Side Effects</a></li><li><a class=" " href="/guides/code-splitting/">Code Splitting</a></li><li><a class=" " href="/guides/loading/">Loading Route Data</a></li><li><a class=" " href="/guides/ssr/">Server-Side Rendering</a></li><li><a class=" " href="/guides/apollo/">Apollo Integration</a></li></ul></menu></ul></div></li><li class="p-0 pr-2 pl-0" aria-haspopup="true"><a class=" text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange " href="/tutorial/">Tutorials</a><div class="hidden absolute w-screen left-0 text-purple border-0 border-b-2 border-purple"><ul class="flex flex-row flex-no-wrap justify-start bg-light-blue list-none m-0 p-0"><menu class="my-0 mx-5"><h3>Basic</h3><ul><li><a class=" " href="/tutorial/react-basics/">React Basics</a></li><li><a class=" " href="/tutorial/vue-basics/">Vue Basics</a></li></ul></menu><menu class="my-0 mx-5"><h3>Advanced</h3><ul><li><a class=" " href="/tutorial/react-advanced/">React Advanced</a></li></ul></menu></ul></div></li><li class="p-0 pr-2 pl-0" aria-haspopup="true"><a class=" text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange " href="/examples/">Examples</a><div class="hidden absolute w-screen left-0 text-purple border-0 border-b-2 border-purple"><ul class="flex flex-row flex-no-wrap justify-start bg-light-blue list-none m-0 p-0"><menu class="my-0 mx-5"><ul style="margin:0 25px"><li><a class=" " href="/examples/basic/">Basic</a></li><li><a class=" " href="/examples/accessibility/">Focus Management</a></li><li><a class=" " href="/examples/active/">Active Routes</a></li><li><a class=" " href="/examples/async/">Async Routes &amp; Navigation</a></li><li><a class=" " href="/examples/breadcrumbs/">Breadcrumbs</a></li><li><a class=" " href="/examples/confirmation/">Navigation Confirmation</a></li><li><a class=" " href="/examples/redirects/">Redirects</a></li><li><a class=" " href="/examples/multi-body/">Multiple Body Components</a></li><li><a class=" " href="/examples/transitions/">Route Transitions</a></li><li><a class=" " href="/examples/modal/">Modal Content</a></li><li><a class=" " href="/examples/spotify/">Spotify Clone</a></li><li><a class=" " href="/examples/twitch/">Twitch Clone</a></li><li><a class=" " href="/examples/code-splitting/">Code Splitting</a></li><li><a class=" " href="/examples/script-tags/">Script Tags</a></li><li><a class=" " href="/examples/server-rendering/">Server Rendering</a></li><li><a class=" " href="/examples/side-effects/">Side Effects</a></li></ul></menu></ul></div></li><li class="p-0 pr-2 pl-0"><a class="text-gray-100 text-xl no-underline h-10 flex items-center px-2 border-0 border-b-2 border-purple hover:text-bright-orange" href="https://github.com/pshrmn/curi">GitHub</a></li></ul></nav></header><menu class="fixed w-screen h-8 left-0 bottom-0 flex flex-row flex-no-wrap justify-between z-50"><button class="h-8 flex-grow text-xl border-0 bg-button-green md:hidden">Menu</button></menu><menu hidden="" class=" fixed overflow-y-scroll w-screen h-screen bg-gray-100 z-40 p-0 pb-10 md:hidden"><div data-reach-tabs=""><div data-reach-tab-list="" role="tablist"><button data-reach-tab="" role="tab" id="tab:null:0" tabindex="0" aria-selected="true" aria-controls="panel:null:0" data-selected="">Main</button><button data-reach-tab="" role="tab" id="tab:null:1" tabindex="-1" aria-selected="false" aria-controls="panel:null:1">Page</button></div><div data-reach-tab-panels="" class="py-0 px-3"><div data-reach-tab-panel="" role="tabpanel" tabindex="-1" aria-labelledby="tab:null:0" id="panel:null:0"><ul class="my-1 mx-0 p-0 list-none"><li><a class=" home-link" href="/">Curi</a></li><li><ul><li class="mb-3"><button title="Toggle group visibility" class="cursor-pointer text-left w-full bg-transparent border-0 p-0 text-purple"><svg width="25" height="15" viewBox="0 0 25 15" xmlns="http://www.w3.org/2000/svg" class="inline-block"><path d="M2,5 l5,5 l5,-5" fill="none" stroke="black" stroke-width="3"></path></svg>API</button></li></ul></li><li><ul><li class="mb-3"><button title="Toggle group visibility" class="cursor-pointer text-left w-full bg-transparent border-0 p-0 text-purple"><svg width="25" height="15" viewBox="0 0 25 15" xmlns="http://www.w3.org/2000/svg" class="inline-block"><path d="M2,5 l5,5 l5,-5" fill="none" stroke="black" stroke-width="3"></path></svg>Guides</button></li></ul></li><li><ul><li class="mb-3"><button title="Toggle group visibility" class="cursor-pointer text-left w-full bg-transparent border-0 p-0 text-purple"><svg width="25" height="15" viewBox="0 0 25 15" xmlns="http://www.w3.org/2000/svg" class="inline-block"><path d="M2,5 l5,5 l5,-5" fill="none" stroke="black" stroke-width="3"></path></svg>Tutorials</button></li></ul></li><li><ul><li class="mb-3"><button title="Toggle group visibility" class="cursor-pointer text-left w-full bg-transparent border-0 p-0 text-purple"><svg width="25" height="15" viewBox="0 0 25 15" xmlns="http://www.w3.org/2000/svg" class="inline-block"><path d="M2,5 l5,5 l5,-5" fill="none" stroke="black" stroke-width="3"></path></svg>Examples</button></li></ul></li><li><a href="https://github.com/pshrmn/curi">GitHub</a></li></ul></div><div data-reach-tab-panel="" role="tabpanel" tabindex="-1" aria-labelledby="tab:null:1" hidden="" id="panel:null:1"><menu class="max-w-full p-0 m-0"><ol class="my-1 mx-0 p-0 list-none p-0"><li><a class="no-underline" href="#response-handlers">Response Handlers</a></li><li><a class="no-underline" href="#registering">Registering Response Handlers</a></li><li><a class="no-underline" href="#use-cases">Use Cases</a><ol class="my-1 mx-0 p-0 list-none pl-3"><li><a class="no-underline" href="#setup">Setup</a></li><li><a class="no-underline" href="#rendering">Rendering</a></li><li><a class="no-underline" href="#side-effects">Side Effects</a></li></ol></li></ol></menu></div></div></div></menu><main tabindex="-1" class="w-screen max-w-full pt-3 px-3 pb-0 mb-10 md:pt-10 md:px-0 md:mb-0"><div class="relative md:flex md:flex-row md:flex-no-wrap md:max-w-full"><div class="hidden md:block md:w-64 md:bg-gray-100 md:fixed md:bottom-0 md:overflow-auto md:flex-grow-0 md:flex-shrink-0 md:p-6 md:mr-6" style="top:2rem"><menu class="max-w-full p-0 m-0"><ol class="my-1 mx-0 p-0 list-none p-0"><li><a class="no-underline" href="#response-handlers">Response Handlers</a></li><li><a class="no-underline" href="#registering">Registering Response Handlers</a></li><li><a class="no-underline" href="#use-cases">Use Cases</a><ol class="my-1 mx-0 p-0 list-none pl-3"><li><a class="no-underline" href="#setup">Setup</a></li><li><a class="no-underline" href="#rendering">Rendering</a></li><li><a class="no-underline" href="#side-effects">Side Effects</a></li></ol></li></ol></menu></div><article class="md:ml-64 md:pl-8"><section class="mt-3 md:max-w-2xl "><h1 class="outline-none" tabindex="-1">New Responses</h1><p class="m-0 mb-4 text-base md:text-lg ">Curi uses an observer pattern to call registered functions (called response handlers) when there is a new response. The primary use care for this is to re-render the application whenever there is a new response, but other functionalities (like logging) can also be performed.</p></section><section class="mt-3 md:max-w-2xl"><h2 id="response-handlers" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#response-handlers">Response Handlers</a></h2><p class="m-0 mb-4 text-base md:text-lg ">When response handlers are called, they are passed an object with three properties:<!-- --> <a href="/v2/@curi/router/#properties"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router</code></a>,<!-- --> <a href="/guides/responses/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">response</code></a>, and<!-- --> <a href="/guides/navigation-objects/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">navigation</code></a>. Which objects/properties you use depends on what the response handler is doing.</p><figure class="m-0 mb-4"><pre class="align-top h-full whitespace-pre-wrap"><code class="language-javascript md:whitespace-pre-wrap">function responseHandler({
  router,
  response,
  navigation
}) {
  // ...
}</code></pre></figure></section><section class="mt-3 md:max-w-2xl"><h2 id="registering" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#registering">Registering Response Handlers</a></h2><p class="m-0 mb-4 text-base md:text-lg ">There are three ways to attach response handlers to the router:<!-- --> <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.once</code> and <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code> or as a side effect.</p><p class="m-0 mb-4 text-base md:text-lg ">Response handlers registered with <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.once</code> will only be called one time, while those registered with <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code> <!-- -->and side effects will be called for every new response.</p><p class="m-0 mb-4 text-base md:text-lg ">When you register a response handler using <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code>, it will return a function that you can use to stop calling the response handler for new responses. You should rarely need to do this, but it can be useful for memory management if you are adding and removing lots of observers.</p><figure class="m-0 mb-4"><pre class="align-top h-full whitespace-pre-wrap"><code class="language-javascript md:whitespace-pre-wrap">// fn will only be called one time
router.once(fn);

// obs will be called for every new response
let stop = router.observe(fn);</code></pre></figure></section><section class="mt-3 md:max-w-2xl"><h2 id="use-cases" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#use-cases">Use Cases</a></h2><p class="m-0 mb-4 text-base md:text-lg ">What should you use response handlers for?</p><section class="mt-3 md:max-w-2xl"><h3 id="setup" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#setup">Setup</a></h3><p class="m-0 mb-4 text-base md:text-lg ">If any of the routes in an application have <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">resolve</code> <!-- -->functions, when they match their responses are created asynchronously. When the application first renders, if the router matches an async route, the response isn&#x27;t immediately ready to use. To deal with this, you can use an observer to render once the initial response is ready.</p><p class="m-0 mb-4 text-base md:text-lg ">A setup function only needs to be called one time, so you can register it with <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.once</code>.</p><aside class="py-2 px-1 my-1 mx-0 border-gray-300 bg-gray-200"><strong>Note:</strong> <p class="m-0 mb-4 text-base md:text-lg ">In most applications, waiting for the initial response is the only time you may need to write response handlers yourself.</p></aside><figure class="m-0 mb-4"><pre class="align-top h-full whitespace-pre-wrap"><code class="language-jsx md:whitespace-pre-wrap">let Router = createRouterComponent(router);

function setup() {
  ReactDOM.render((
    &lt;Router&gt;
      &lt;App /&gt;
    &lt;/Router&gt;
  ), document.getElementById(&#x27;root&#x27;));
}

router.once(setup);</code></pre></figure></section><section class="mt-3 md:max-w-2xl"><h3 id="rendering" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#rendering">Rendering</a></h3><p class="m-0 mb-4 text-base md:text-lg ">Rendering libraries need to know when there is a new response so that they can re-render the application.</p><p class="m-0 mb-4 text-base md:text-lg ">The Curi rendering packages (<a href="/v2/@curi/react-dom/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/react-dom</code></a>,<!-- --> <a href="/v2/@curi/react-native/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/react-native</code></a>,<!-- --> <a href="/v1/@curi/vue/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/vue</code></a>, and<!-- --> <a href="/v1/@curi/svelte/"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/svelte</code></a>) setup an observer internally so that they can automatically re-render.</p><p class="m-0 mb-4 text-base md:text-lg ">If you are using vanilla JavaScript to render your application or you are writing your own framework implementation, you would use<!-- --> <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code> to re-render new responses.</p><figure class="m-0 mb-4"><pre class="align-top h-full whitespace-pre-wrap"><code class="language-javascript md:whitespace-pre-wrap">function observer({ response }) {
  // let the app know there is a new response
}

router.observe(observer);</code></pre></figure></section><section class="mt-3 md:max-w-2xl"><h3 id="side-effects" class="hash-anchor-fix outline-none" tabindex="-1"><a class="header-link no-underline" href="#side-effects">Side Effects</a></h3><p class="m-0 mb-4 text-base md:text-lg ">Side effects are observers that are provided to the router at creation instead of by calling <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code>. These can be useful for tasks that are not rendering related as well as for tasks that need to be performed after a render has completed.</p><p class="m-0 mb-4 text-base md:text-lg ">The<!-- --> <a href="/v2/@curi/router/#title"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">title</code></a> <!-- -->function exported by <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/router</code> is a side effect that will use <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">response.meta.title</code> to set the page&#x27;s<!-- --> <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">document.title</code>.</p><p class="m-0 mb-4 text-base md:text-lg ">With single-page applications, clicking on links wish hashes won&#x27;t always scroll to the matching element in the page. The<!-- --> <a href="/v2/@curi/router/#scroll"><code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">scroll</code></a> <!-- -->function exported by <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">@curi/router</code> is a side effect that scrolls the page to the element that matches the new response&#x27;s hash (<code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">response.location.hash</code>) after the new response has rendered.</p><p class="m-0 mb-4 text-base md:text-lg ">If you need to add logging to your application, you could write your own observer to do this. Your observer can either be added as a side effect when the router is constructed or later using<!-- --> <code class=" p-1 rounded whitespace-normal background-white text-purple" style="text-shadow:none">router.observe</code>.</p><figure class="m-0 mb-4"><pre class="align-top h-full whitespace-pre-wrap"><code class="language-javascript md:whitespace-pre-wrap">function logger({ response }) {
  loggingAPI.add(response.location);
}

// as a side-effect
let router = createRouter(browser, routes, {
  sideEffects: [{ fn: logger }]
});

// as an observer
router.observe(logger);</code></pre></figure></section></section></article></div></main></div>
    <script src="https://unpkg.com/react@16.13.1/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@16.13.1/umd/react-dom.production.min.js"></script>
    <script src="/static/js/highlight.js"></script>
    <script src="/static/js/bundle.js"></script>
  </body>
</html>
